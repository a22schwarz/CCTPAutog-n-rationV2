<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Générateur de CCTP – Formulaire</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Police identique au reste du projet -->
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    /* =========================
       Thème & bases typographiques
       ========================= */
    :root{
      --orange:#ff5a37; --green:#175649;
      --grey:#e6e6e6;  --bg:#f4f4f4;
      --text:#1f3b36;  --muted:#6b7b76;
      --line:#e8eceb;  --shadow:0 10px 30px rgba(0,0,0,.05);
      --radius:14px;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family:'Source Sans Pro',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text); background:var(--bg); line-height:1.5;
    }

    /* =========================
       Habillage page
       ========================= */
    #bg-video{position:fixed; inset:0; width:100%; height:100%; object-fit:cover; z-index:-2}
    #bg-overlay{position:fixed; inset:0; background:rgba(23,86,73,.55); z-index:-1}

    .container{
      max-width: 1280px;  /* was 1040px */
      margin:40px auto;
      padding:0 16px;
    }

    header{display:flex; align-items:center; gap:20px; margin-bottom:20px}
    .logo{width:120px}
    h1{margin:0; font-size:2rem; font-weight:700; color:var(--orange)}
    .muted{color:var(--muted); margin:.25rem 0 0}

    /* =========================
       Cartes / sections
       ========================= */
    .card{
      background:#fff; border:1px solid var(--line); border-radius:var(--radius);
      padding:22px; box-shadow:var(--shadow); margin:18px 0;
    }
    .card h3{
      margin:0 0 14px; font-size:1.25rem; font-weight:700;
    }

    /* =========================
       Grilles formulaire
       ========================= */
    .grid-3{display:grid; grid-template-columns:repeat(3, 1fr); gap:14px}
    .grid-2{display:grid; grid-template-columns:repeat(2, 1fr); gap:14px}
    @media (max-width: 900px){ .grid-3{grid-template-columns:1fr 1fr} }
    @media (max-width: 640px){ .grid-3,.grid-2{grid-template-columns:1fr} }

    .group{display:flex; flex-direction:column; gap:6px}
    .group label{font-weight:600; color:var(--muted); font-size:.95rem}
    .group input[type="text"], .group select{
      width:100%; padding:.6rem .7rem; border:1px solid var(--grey); border-radius:10px; font-size:1rem; background:#fff;
    }
    .group input[type="text"]:focus, .group select:focus{
      outline:none; border-color:#9cc7be; box-shadow:0 0 0 4px rgba(156,199,190,.25);
    }

    /* =========================
       Table param. zones
       ========================= */
    .table-wrap{overflow-x:auto; margin:10px 0}
    table{width:100%; border-collapse:separate; border-spacing:0; background:#fff; border:1px solid var(--line); border-radius:12px; overflow:hidden}
    thead th{
      position:sticky; top:0; background:var(--orange); color:#fff; font-weight:700;
      padding:12px; text-transform:uppercase; font-size:.9rem; text-align:center;
    }
    thead th:first-child{background:#fff; color:var(--text); text-align:left}
    tbody th{
      background:var(--green); color:#fff; padding:10px; text-align:left; font-weight:700; width:220px; vertical-align:top;
    }
    tbody td{padding:10px; border-top:1px solid var(--line); font-size:.95rem; vertical-align:top}
    tbody tr:nth-child(even) td{background:#fafafa}

    /* =========================
       Boutons
       ========================= */
    .btn{
      padding:.65rem 1rem; font-weight:700; color:#fff; background:var(--orange);
      border:none; border-radius:10px; cursor:pointer; transition:background .2s, transform .08s;
    }
    .btn:hover{background:var(--green); transform:translateY(-1px)}
    .btn-ghost{
      background:#fff; color:var(--green); border:1px solid var(--green);
    }
    .btn-ghost:hover{background:var(--green); color:#fff}
    .actions{display:flex; gap:.5rem; margin-bottom:.6rem}

    /* =========================
       Éditeurs “Ombrières / Hangars”
       (plus stylés et lisibles)
       ========================= */
    .editor{margin-top:.5rem}
    .editor table{border:1px solid var(--line); border-radius:12px; overflow:hidden}
    .editor thead th{background:var(--orange); color:#fff; text-align:left}
    .editor th, .editor td{border-top:1px solid var(--line)}
    .editor tr:first-child td, .editor tr:first-child th{border-top:none}
    .editor td input[type="text"], .editor td input[type="number"], .editor td select{
      width:100%; padding:.5rem .6rem; border:1px solid var(--grey); border-radius:8px; font-size:.95rem; background:#fff;
    }
    .editor .col-idx{width:42px; text-align:center; color:#555}
    .chip{
      display:inline-flex; align-items:center; gap:.5rem; padding:.4rem .6rem;
      background:#f7fbfa; border:1px solid var(--line); border-radius:999px; font-weight:600; color:var(--green);
    }
        .table-wrap{ overflow-x: hidden; }            /* was: auto */
    table{ table-layout: fixed; }                 /* forces columns to wrap, not expand */

    /* shrink the first (label) column a bit */
    tbody th{ width: 180px; }                     /* was: 220px */

    /* allow text and selects to wrap/fit */
    thead th, tbody td{ padding: 8px; }           /* a touch tighter */
    tbody td{ word-break: break-word; }           /* break long strings when needed */
    tbody td select,
    tbody td input[type="text"],
    tbody td input[type="number"]{
      width: 100%;
      max-width: 100%;
      min-width: 0;                               /* lets items shrink in fixed layout */
      font-size: .9rem;
      padding: .35rem .5rem;
    }
  </style>
</head>
<body>

  <!-- Vidéo de fond -->
  <video id="bg-video" autoplay muted loop>
    <source src="{{ url_for('static', filename='videos/bron_drone.mp4') }}" type="video/mp4">
  </video>
  <div id="bg-overlay"></div>

  <main class="container">
    <!-- En-tête -->
    <header>
      <img src="{{ url_for('static', filename='img/virya_logo.svg') }}" alt="Logo Virya" class="logo" />
      <div>
        <h1>Générateur de CCTP</h1>
        <p class="muted">Complétez les champs, choisissez les options par zone, puis générez le document.</p>
      </div>
    </header>

    <form method="POST" action="/generate" autocomplete="off" novalidate>
      <!-- Ces 2 champs véhiculent le CSV et les zones jusqu’à /generate -->
      <textarea name="csv_text" hidden>{{ csv_text }}</textarea>
      <input type="hidden" name="zones_json" value='{{ zones_json|safe }}' />

      <!-- =============== Bloc : Informations générales =============== -->
      <section class="card">
        <h3>Informations générales</h3>

        <!-- Lignes AC/VT et BT/MT -->
        <div class="grid-3">
          <div class="group">
            <label for="AC_VT">AC / VT</label>
            <select name="AC_VT" id="AC_VT">
              <option value="Autoconsommation" {% if AC_VT == 'Autoconsommation' %}selected{% endif %}>Autoconsommation</option>
              <option value="Vente Totale" {% if AC_VT == 'Vente Totale' %}selected{% endif %}>Vente Totale</option>
            </select>
          </div>
          <div class="group">
            <label for="bt_mt">BT / MT</label>
            <select name="bt_mt" id="bt_mt">
              <option value="BT" {% if bt_mt == 'BT' %}selected{% endif %}>BT (Basse Tension)</option>
              <option value="MT" {% if bt_mt == 'MT' %}selected{% endif %}>MT (Moyenne Tension)</option>
            </select>
          </div>
        </div>

        <!-- Lignes Nom / Ville / Adresse -->
        <div class="grid-3">
          <div class="group">
            <label for="nom_projet">Nom du projet</label>
            <input type="text" id="nom_projet" name="nom_projet" value="{{ nom_projet }}" />
          </div>
          <div class="group">
            <label for="ville">Ville</label>
            <input type="text" id="ville" name="ville" value="{{ ville }}" />
          </div>
          <div class="group">
            <label for="adresse">Adresse</label>
            <input type="text" id="adresse" name="adresse" value="{{ adresse }}" />
          </div>
        </div>

        <!-- Lignes Latitude / Longitude -->
        <div class="grid-2">
          <div class="group">
            <label for="latitude">Latitude</label>
            <input type="text" id="latitude" name="latitude" value="{{ latitude }}" placeholder="48.8566" />
          </div>
          <div class="group">
            <label for="longitude">Longitude</label>
            <input type="text" id="longitude" name="longitude" value="{{ longitude }}" placeholder="2.3522" />
          </div>
        </div>
      </section>

      <!-- =============== Bloc : Paramètres par zone (table) =============== -->
      <section class="card">
        <h3>Paramètres par zone</h3>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Paramètre</th>
                {% for z in zones %}<th>{{ z.name }}</th>{% endfor %}
              </tr>
            </thead>
            <tbody>
              <tr><th>Type</th>{% for z in zones %}<td>{{ z.type }}</td>{% endfor %}</tr>
              <tr><th>Puissance (kWc)</th>{% for z in zones %}<td>{{ z.puissance }}</td>{% endfor %}</tr>
              <tr><th>Nb de panneaux</th>{% for z in zones %}<td>{{ z.modules }}</td>{% endfor %}</tr>

              <!-- Sélection intégration -->
              <tr>
                <th>Système d’intégration</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-integration">
                      <option value="">— Sélectionner —</option>
                      {% for opt in integration_options_per_zone[i] %}
                        <option value="{{ opt }}" {% if opt==request.form.get('zone-'~i~'-integration') %}selected{% endif %}>{{ opt }}</option>
                      {% endfor %}
                    </select>
                  </td>
                {% endfor %}
              </tr>

              <!-- Module / onduleur -->
              <tr>
                <th>Panneau</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-module">
                      <option value="">— Sélectionner —</option>
                      {% for opt in panel_options %}
                        <option value="{{ opt }}" {% if opt==request.form.get('zone-'~i~'-module') %}selected{% endif %}>{{ opt }}</option>
                      {% endfor %}
                    </select>
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Onduleur</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-inverter">
                      <option value="">— Sélectionner —</option>
                      {% for opt in inverter_options %}
                        <option value="{{ opt }}" {% if opt==request.form.get('zone-'~i~'-inverter') %}selected{% endif %}>{{ opt }}</option>
                      {% endfor %}
                    </select>
                  </td>
                {% endfor %}
              </tr>

              <!-- Bridage statique -->
              <tr>
                <th>Bridage statique</th>
                {% for i in range(zones|length) %}
                  <td>
                    <label><input type="checkbox" name="zone-{{ i }}-bridage_enabled" {% if request.form.get('zone-'~i~'-bridage_enabled') %}checked{% endif %} /> Oui</label>
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Valeur du bridage (kVA)</th>
                {% for i in range(zones|length) %}
                  <td><input type="text" name="zone-{{ i }}-bridage_value" value="{{ request.form.get('zone-'~i~'-bridage_value','') }}" placeholder="Ex : 80" /></td>
                {% endfor %}
              </tr>

              <!-- Bridage dynamique global -->
              <tr>
                <th>Bridage dynamique (global)</th>
                <td colspan="{{ zones|length }}">
                  <label><input type="checkbox" name="bridage_dyn" {% if request.form.get('bridage_dyn') %}checked{% endif %} /> Oui</label>
                </td>
              </tr>
              <tr>
                <th>Valeur bridage dynamique (kVA)</th>
                <td colspan="{{ zones|length }}"><input type="text" name="bridage_dyn_value" value="{{ request.form.get('bridage_dyn_value','') }}" placeholder="Ex : 100" /></td>
              </tr>

              <!-- Autres options -->
              <tr>
                <th>Coffret DC</th>
                {% for i in range(zones|length) %}
                  <td><label><input type="checkbox" name="zone-{{ i }}-coffret_dc" {% if request.form.get('zone-'~i~'-coffret_dc') %}checked{% endif %} /> OUI</label></td>
                {% endfor %}
              </tr>
              <tr>
                <th>Supervision / Webdyn</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-webdyn">
                      {% set cur = request.form.get('zone-'~i~'-webdyn','Aucun') %}
                      {% for val in ['Aucun','Webdyn simple','Webdyn avec bridage dynamique','Coffret de supervision ELUM'] %}
                        <option value="{{ val }}" {% if cur==val %}selected{% endif %}>{{ val }}</option>
                      {% endfor %}
                    </select>
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Paratonnerre</th>
                {% for i in range(zones|length) %}
                  <td><label><input type="checkbox" name="zone-{{ i }}-paratonnerre" {% if request.form.get('zone-'~i~'-paratonnerre') %}checked{% endif %} /> OUI</label></td>
                {% endfor %}
              </tr>
              <tr>
                <th>Schéma de liaison à la terre</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-liaison_terre">
                      {% for val in ['IT','TT','TNC','TNS','TNCS'] %}<option value="{{ val }}">{{ val }}</option>{% endfor %}
                    </select>
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Type de découplage</th>
                {% for i in range(zones|length) %}
                  <td>
                    <select name="zone-{{ i }}-decouplage">
                      <option value="ajout_relais">Ajout d'un relais de découplage</option>
                      <option value="modification_relais">Modification de la programmation du relais</option>
                      <option value="ajout_cellule_comptage">Ajout d'une cellule de comptage</option>
                      <option value="Cellule_dans_HTA"> Cellule prévue dans le poste HTA</option>
                    </select>
                  </td>
                {% endfor %}
              </tr>

              <!-- Listes de cases (valorisation, typologie, référentiel, spécificités) -->
              <tr>
                <th>Mode de valorisation</th>
                {% for i in range(zones|length) %}
                  <td style="text-align:left">
                    {% for val,label in [('S21','S21'),('AO CRE','AO CRE (Période de candidature)'),('Agrégateur','Agrégateur'),('Sans revente','Sans revente')] %}
                      <label style="display:block; font-weight:normal"><input type="checkbox" name="zone-{{ i }}-mode_valorisation" value="{{ val }}" {% if val in request.form.getlist('zone-'~i~'-mode_valorisation') %}checked{% endif %} /> {{ label }}</label>
                    {% endfor %}
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Typologie du bâtiment</th>
                {% for i in range(zones|length) %}
                  <td style="text-align:left">
                    {% for opt in ['ICPE','ERP','ERT'] %}
                      <label style="display:block; font-weight:normal"><input type="checkbox" name="zone-{{ i }}-typologie_batiment" value="{{ opt }}" {% if opt in request.form.getlist('zone-'~i~'-typologie_batiment') %}checked{% endif %} /> {{ opt }}</label>
                    {% endfor %}
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Référentiel technique</th>
                {% for i in range(zones|length) %}
                  <td style="text-align:left">
                    {% for opt in ['FM Global','APSAD D20','Avis technique','ETN'] %}
                      <label style="display:block; font-weight:normal"><input type="checkbox" name="zone-{{ i }}-referentiel_technique" value="{{ opt }}" {% if opt in request.form.getlist('zone-'~i~'-referentiel_technique') %}checked{% endif %} /> {{ opt }}</label>
                    {% endfor %}
                  </td>
                {% endfor %}
              </tr>
              <tr>
                <th>Autres spécificités</th>
                {% for i in range(zones|length) %}
                  <td style="text-align:left">
                    {% for opt in ['ABF','Aéroport','PPRI','Préconisations SDIS'] %}
                      <label style="display:block; font-weight:normal"><input type="checkbox" name="zone-{{ i }}-autres_specificites" value="{{ opt }}" {% if opt in request.form.getlist('zone-'~i~'-autres_specificites') %}checked{% endif %} /> {{ opt }}</label>
                    {% endfor %}
                  </td>
                {% endfor %}
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- =============== Bloc : Lots à inclure =============== -->
      <section class="card">
        <h3>Lots à inclure</h3>
        <div class="grid-2">
          <label class="chip"><input type="checkbox" name="keep_lot_fondations_speciales" {% if 'keep_lot_fondations_speciales' in request.form %}checked{% endif %} /> Fondations spéciales</label>
          <label class="chip"><input type="checkbox" name="keep_lot_gros_oeuvre" {% if 'keep_lot_gros_oeuvre' in request.form %}checked{% endif %} /> Gros œuvre</label>

          <!-- Cette case pilote l’affichage du bloc Charpente ci-dessous -->
          <label class="chip"><input type="checkbox" name="keep_lot_charpente" id="lot-charpente" {% if 'keep_lot_charpente' in request.form %}checked{% endif %} /> Charpente</label>

          <label class="chip"><input type="checkbox" name="keep_lot_bornes" {% if 'keep_lot_bornes' in request.form %}checked{% endif %} /> Bornes de recharge</label>
        </div>
      </section>

      <!-- =============== Bloc : Charpente — éléments spécifiques
           -> ENTIEREMENT MASQUÉ si "Lot Charpente" n'est pas coché
           =============== -->
      {% set charpente_on = ('keep_lot_charpente' in request.form) %}
      <section class="card" id="charpente-block" style="display:{{ 'block' if charpente_on else 'none' }};">
        <h3>Charpente — éléments spécifiques</h3>

        <!-- Sous-bloc Ombrières -->
        <div class="group">
          <label><input type="checkbox" name="Ombrieres" id="cb-ombrieres" checked /> Présence d’Ombrières</label>
        </div>

        <div class="editor" id="ombrieres-editor">
          <div class="actions">
            <button type="button" class="btn" data-add="omb">Ajouter une ligne</button>
            <button type="button" class="btn btn-ghost" data-clear="omb">Vider</button>
          </div>
          <table>
            <thead>
              <tr>
                <th class="col-idx">#</th>
                <th>Description</th>
                <th>Nb modules en largeur</th>
                <th>Orientation</th>
                <th>Inclinaison (°)</th>
                <th>Hauteur bas de pente</th>
                <th style="width:1%"></th>
              </tr>
            </thead>
            <tbody id="omb-body"></tbody>
          </table>
          <input type="hidden" name="omb_table" id="omb_table" />
        </div>

        <!-- Sous-bloc Hangars -->
        <div class="group" style="margin-top:1rem">
          <label><input type="checkbox" name="Hangars" id="cb-hangars" checked /> Présence de Hangars</label>
        </div>

        <div class="editor" id="hangars-editor">
          <div class="actions">
            <button type="button" class="btn" data-add="hang">Ajouter une ligne</button>
            <button type="button" class="btn btn-ghost" data-clear="hang">Vider</button>
          </div>
          <table>
            <thead>
              <tr>
                <th class="col-idx">#</th>
                <th>Description</th>
                <th>Nb modules en largeur</th>
                <th>Orientation</th>
                <th>Inclinaison (°)</th>
                <th>Hauteur bas de pente</th>
                <th style="width:1%"></th>
              </tr>
            </thead>
            <tbody id="hang-body"></tbody>
          </table>
          <input type="hidden" name="hang_table" id="hang_table" />
        </div>
      </section>

      <!-- =============== Bloc : VRD =============== -->
      <section class="card">
        <h3>VRD — réseaux humides</h3>
        <div class="grid-2">
          <label class="chip"><input type="checkbox" name="travaux_rh" {% if 'travaux_rh' in request.form %}checked{% endif %} /> Travaux réseaux humides</label>
          <label class="chip"><input type="checkbox" name="ouvrages_retention" {% if 'ouvrages_retention' in request.form %}checked{% endif %} /> Ouvrages de rétention des eaux pluviales</label>
        </div>
      </section>

      <!-- Bouton principal -->
      <div style="text-align:center; margin:22px 0 10px">
        <button type="submit" class="btn">Générer le CCTP</button>
      </div>
    </form>
  </main>

  <script>
    /* ===========================================================
       1) Masquer/afficher tout le bloc “Charpente” selon la case
          "keep_lot_charpente" — sans recharger la page
       =========================================================== */
    const lotCharpente = document.getElementById('lot-charpente');   // case "Charpente"
    const charpenteBlk = document.getElementById('charpente-block'); // section complète
    function syncCharpenteVis(){ charpenteBlk.style.display = lotCharpente.checked ? 'block' : 'none'; }
    lotCharpente?.addEventListener('change', syncCharpenteVis);
    syncCharpenteVis(); // état initial au chargement

    /* ===========================================================
       2) Fabrique réutilisable pour les tables dynamiques
          (Ombrières & Hangars partagent exactement le même code)
       =========================================================== */
    function buildDynamicTable(cfg){
      // Références DOM
      const body   = document.getElementById(cfg.bodyId);
      const addBtn = document.querySelector(`[data-add="${cfg.key}"]`);
      const clrBtn = document.querySelector(`[data-clear="${cfg.key}"]`);
      const sec    = document.getElementById(cfg.sectionId);
      const toggle = document.getElementById(cfg.toggleId);
      const hidden = document.getElementById(cfg.hiddenId);

      // Numérote la 1ère colonne
      function renumber(){
        [...body.querySelectorAll('tr')].forEach((tr,i)=>{
          const n = tr.querySelector('.col-idx'); if(n) n.textContent = i + 1;
        });
      }

      // Ajoute une ligne avec valeurs par défaut (ou passées en paramètre)
      function addRow(data){
        const d = Object.assign({desc:'', modules:'6', orient:'Portrait', incli:'10', hbp:'3.5m'}, data||{});
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="col-idx"></td>
          <td><input type="text" placeholder="Description" value="${d.desc}"/></td>
          <td>
            <select>
              ${[2,3,4,5,6,7,8,9,10,11,12].map(n=>`<option ${String(n)===String(d.modules)?'selected':''}>${n}</option>`).join('')}
            </select>
          </td>
          <td>
            <select>
              <option ${d.orient==='Portrait'?'selected':''}>Portrait</option>
              <option ${d.orient==='Paysage'?'selected':''}>Paysage</option>
            </select>
          </td>
          <td><input type="number" step="0.5" min="0" max="60" value="${d.incli}"/></td>
          <td><input type="text" placeholder="ex: 3.5m" value="${d.hbp}"/></td>
          <td style="text-align:right"><button type="button" class="btn btn-ghost btn-del">Suppr</button></td>
        `;
        body.appendChild(tr); renumber();
      }

      // Boutons “Ajouter” et “Vider”
      addBtn?.addEventListener('click',()=>addRow());
      clrBtn?.addEventListener('click',()=>{ body.innerHTML=''; renumber(); });

      // Suppression d’une ligne
      body?.addEventListener('click', (e)=>{
        if(e.target.closest('.btn-del')){ e.target.closest('tr').remove(); renumber(); }
      });

      // 1 ligne par défaut pour guider l’utilisateur
      addRow();

      // Masque/affiche la section selon sa checkbox locale (Ombrières / Hangars)
      function syncLocal(){ if(sec && toggle){ sec.style.display = toggle.checked ? '' : 'none'; } }
      toggle?.addEventListener('change', syncLocal); syncLocal();

      // Sérialisation en JSON AVANT l’envoi du formulaire
      (document.querySelector('form[action="/generate"]') || document.querySelector('form'))
        ?.addEventListener('submit', ()=>{
          const rows = [...body.querySelectorAll('tr')].map(tr=>{
            const idx = tr.querySelector('.col-idx')?.textContent.trim() || '';
            const inputs = tr.querySelectorAll('td select, td input');
            const [desc, modules, orient, incli, hbp] = [...inputs].map(i=>i.value.trim());
            return { type: idx, desc, modules, orient, incli, hbp };
          }).filter(r => r.desc || r.modules || r.orient || r.incli || r.hbp);
          hidden.value = JSON.stringify(rows);
        });
    }

    // Instanciation pour les deux tableaux
    buildDynamicTable({
      key:'omb', bodyId:'omb-body', sectionId:'ombrieres-editor', toggleId:'cb-ombrieres', hiddenId:'omb_table'
    });
    buildDynamicTable({
      key:'hang', bodyId:'hang-body', sectionId:'hangars-editor', toggleId:'cb-hangars', hiddenId:'hang_table'
    });
  </script>
</body>
</html>
